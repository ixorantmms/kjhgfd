Improve performance [bcHhGe] line 3.1
Improve performance [JKgyej] line 7.3
Add test case for W [VilsKl] line 9.1
